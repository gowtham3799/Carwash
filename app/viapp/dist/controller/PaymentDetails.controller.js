sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/UIComponent"],function(e,t,a,o){"use strict";return e.extend("viapp.controller.PaymentDetails",{onInit:function(){this.removeKeyParameter()},onPressNavtoPaymentapp:function(){sap.m.MessageToast.show("Navigating to payment app");var e="39921047";var t="100";var a={Saleorder:"",Invoice:"",MOPType:"",CardNo:"",Authcode:"",TransactionMessage:""};var o=JSON.stringify(a);let r="com.sap.mobile.start://navigation?resolve-type=ibn#viapp-display?sap-ui-app-id-hint=saas_approuter_viapp";let s=encodeURIComponent(r);var i={trxnType:"SALE",amount:t,mode:"card",trxnID:e};var n=JSON.stringify(i);var d=encodeURIComponent(n);console.log(s);var l="adnoc://pay.com/card?data="+d+"&returnUrl="+s;window.location.href=l},ongetSOdetails:function(){var e=this.getView().getModel("oGlobalModel").getData().SR;var o=this.getView().getModel("oGlobalModel").getData().Authcode;this.getView().getModel("CarwashService").read("/Payment",{filters:[new t("ORDERNUM",a.EQ,e)],urlParameters:{$expand:"ITEMS"},success:function(e,t){var a=e.results[0].ITEMS.results;for(var r=0;r<a.length;r++){if(a[r].MOP_TYPE==="CARD"){a[r].AUTH_CODE===o}var s=a[r];this.saveDetails(s)}}.bind(this),error:function(e){MessageBox.error(e.message)}.bind(this)})},saveDetails:function(e){var t={ID:e.ID,PARENT_KEY:e.PARENT_KEY,MOP_COUNTER:e.MOP_COUNTER,AMOUNT:e.AMOUNT,CURRENCY:e.CURRENCY,MOP_TYPE:e.MOP_TYPE,AUTH_CODE:e.AUTH_CODE};var a=this.getView().getModel("CarwashService");a.sDefaultUpdateMethod=sap.ui.model.odata.UpdateMethod.PUT;var a=this.getView().getModel("CarwashService");oModelupdate("/PaymentItem",t,{success:function(e,t){if(e.ID){sap.m.MessageToast.show("Payment Details Updated successfully")}}.bind(this),error:function(e){MessageBox.error(e.message)}.bind(this)})},removeKeyParameter:function(){var e=new URL(window.location.href);var t=["authcode","message","orderid","status"];t.forEach(function(t){e.searchParams.delete(t)});window.history.pushState({},document.title,e.toString());alert("Back to Home");var a=o.getRouterFor(this);a.navTo("Home",{},true)}})});
//# sourceMappingURL=PaymentDetails.controller.js.map