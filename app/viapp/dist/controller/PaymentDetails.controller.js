sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/UIComponent"],function(e,a,t,o){"use strict";return e.extend("viapp.controller.PaymentDetails",{onInit:function(){this._oRouter=sap.ui.core.UIComponent.getRouterFor(this);this._oRouter.attachRouteMatched(this.handleRouteMatched,this)},handleRouteMatched:function(e){},onPressNavtoPaymentapp:function(){sap.m.MessageToast.show("Navigating to payment app");var e="39921047";var a="100";var t={Saleorder:"",Invoice:"",MOPType:"",CardNo:"",Authcode:"",TransactionMessage:""};var o=JSON.stringify(t);let r="com.sap.mobile.start://navigation?resolve-type=ibn#viapp-display?sap-ui-app-id-hint=saas_approuter_viapp";let s=encodeURIComponent(r);var i={trxnType:"SALE",amount:a,mode:"card",trxnID:e};var n=JSON.stringify(i);var p=encodeURIComponent(n);console.log(s);var l="adnoc://pay.com/card?data="+p+"&returnUrl="+s;window.location.href=l},ongetSOdetails:function(){var e=this.getView().getModel("oGlobalModel").getProperty("/Saleorder");var o=this.getView().getModel("oGlobalModel").getProperty("/Authcode");this.getView().getModel("CarwashService").read("/Payment",{filters:[new a("ORDERNUM",t.EQ,e)],urlParameters:{$expand:"ITEMS"},success:function(e,a){var t="";var r=e.results[0].ITEMS.results;for(var s=0;s<r.length;s++){if(r[s].MOP_TYPE==="CARD"){r[s].AUTH_CODE=o;t=r[s]}}if(t){this.saveDetails(t)}}.bind(this),error:function(e){MessageBox.error(e.message)}.bind(this)})},saveDetails:function(e){var a={ID:e.ID,PARENT_KEY_ID:e.PARENT_KEY_ID,MOP_COUNTER:e.MOP_COUNTER,AMOUNT:e.AMOUNT,CURRENCY:e.CURRENCY,MOP_TYPE:e.MOP_TYPE,AUTH_CODE:e.AUTH_CODE};var t=this.getView().getModel("CarwashService");var o="";o=t.createKey("/PaymentItem",{ID:e.ID});t.sDefaultUpdateMethod=sap.ui.model.odata.UpdateMethod.Put;t.update(o,a,{success:function(e,a){if(e.ID){sap.m.MessageToast.show("Payment Details Updated successfully");this.onRemoveKeyParameter()}}.bind(this),error:function(e){MessageBox.error(e.message)}.bind(this)})},removeKeyParameter:function(){var e="com.sap.mobile.start://navigation?resolve-type=ibn#viapp-display?sap-ui-app-id-hint=saas_approuter_viapp";window.history.replaceState({},document.title,e);alert("Back to Home from Payment");var a=o.getRouterFor(this);a.navTo("Home",{},true)},onRemoveKeyParameter:function(){var e="https://f52aef11trial.launchpad.cfapps.us10.hana.ondemand.com/site?appState=lean&shell-mode=cflp&sap-language=en&siteId=c9f0487d-e547-4e95-aac9-0fcdf52eeef3&sap-ushell-config=headerless#vehicleapp-manage&/Home";window.location.replace(e);var a=o.getRouterFor(this);a.navTo("Home",true)}})});
//# sourceMappingURL=PaymentDetails.controller.js.map